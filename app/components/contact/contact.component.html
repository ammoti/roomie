<GridLayout #container class="background" rows="auto,*">
  <!-- Row 1: The custom action bar -->
  <GridLayout row="0" columns="44, *, auto" class="action-bar-custom">
    <Label col="1" text="Roomie Quest List"></Label>

    <!-- Wrap the image in a StackLayout to give it a bigger tap target -->
    <GridLayout col="2" (tap)="showMenu()">
      <Image src="res://menu" stretch="none"></Image>
    </GridLayout>
  </GridLayout>
  <!-- Row 3: The grocery list -->
  <StackLayout [row]="1">
    <PullToRefresh (refresh)="refreshList($event)">
      <ListView
        height="90%"
        margin-bottom="50"
        padding="50"
        row="1"
        #list
        [items]="chats$"
      >
        <ng-template let-item="item">
          <GridLayout columns="*" rows="auto" class="msg">
            <StackLayout
              [class]="filter(item.ufrom)"
              orientation="horizontal"
              [horizontalAlignment]="align(item.ufrom)"
            >
              <Image
                [visibility]="showImage(item.ufrom)"
                class="authorimg"
                stretch="aspectFill"
                height="30"
                width="30"
                verticalAlignment="top"
                col="1"
              ></Image>
              <Label
                [text]="item.message"
                class="msg_text"
                textWrap="true"
                verticalAlignment="top"
              ></Label>
            </StackLayout>
          </GridLayout>
        </ng-template>
      </ListView>
    </PullToRefresh>
    <StackLayout #chatbox height="10%">
      <GridLayout columns="*,auto" style="padding: 10">
        <TextField
          #textfield
          class="chatTextField"
          row="0"
          col="0"
          [(ngModel)]="message"
        ></TextField>
        <Button
          #btn
          class="chatBtn"
          row="0"
          col="1"
          text="send"
          (tap)="chat(message)"
        ></Button>
      </GridLayout>
    </StackLayout>
  </StackLayout>
  <ActivityIndicator [busy]="isLoading" row="2"></ActivityIndicator>
</GridLayout>
